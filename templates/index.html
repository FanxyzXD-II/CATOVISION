<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>CATOVISION AI</title>
    <style>
        :root { --bg:#020617; --card:#0f172a; --text:#f8fafc; --accent:#38bdf8; --border:#1e293b; --ai-bubble: rgba(30, 41, 59, 0.5); }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); margin: 0; padding-bottom: 20px; }
        
        /* Navbar & Navigasi */
        .nav-bar { display: flex; gap: 10px; padding: 15px; background: var(--card); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; overflow-x: auto; }
        .nav-item { cursor: pointer; padding: 8px 16px; border-radius: 10px; font-size: 13px; font-weight: 600; color: #94a3b8; white-space: nowrap; }
        .nav-item.active { background: rgba(56, 189, 248, 0.1); color: var(--accent); border: 1px solid var(--accent); }

        /* Pemilih Bahasa */
        .lang-selector { display: flex; justify-content: flex-end; padding: 10px 20px; gap: 5px; }
        .lang-btn { background: var(--card); border: 1px solid var(--border); color: #fff; padding: 4px 10px; border-radius: 8px; font-size: 11px; cursor: pointer; }
        .lang-btn.active { border-color: var(--accent); color: var(--accent); }

        .container { max-width: 700px; margin: auto; padding: 0 15px; }
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.4s ease; }

        /* Kartu Profil & Home */
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 24px; padding: 25px; text-align: center; margin-bottom: 20px; }
        .ca-box { background: rgba(30, 41, 59, 0.7); padding: 12px; border-radius: 12px; font-family: monospace; font-size: 11px; word-break: break-all; border: 1px dashed var(--accent); color: var(--accent); margin: 15px 0; }
        .btn-tg { background: #0088cc; color: #fff; text-decoration: none; display: block; padding: 14px; border-radius: 12px; font-weight: bold; margin-top: 15px; }
        
        .cat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .cat-card img { width: 100%; height: 160px; object-fit: cover; border-radius: 16px; border: 1px solid var(--border); }

        /* Sistem Chat */
        .chat-container { display: flex; flex-direction: column; height: 75vh; background: #070a13; border-radius: 28px; border: 1px solid var(--border); overflow: hidden; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; }
        .ai-bubble { align-self: flex-start; background: var(--ai-bubble); padding: 15px; border-radius: 0 15px 15px 15px; font-size: 13px; max-width: 90%; line-height: 1.6; }
        .user-bubble { align-self: flex-end; background: var(--accent); color: #000; padding: 10px 15px; border-radius: 15px 15px 0 15px; font-size: 13px; font-weight: bold; }

        /* Quick Actions (Tombol Pintas Akurat) */
        .quick-actions { display: flex; gap: 8px; padding: 10px 20px; overflow-x: auto; background: #070a13; flex-shrink: 0; }
        .btn-quick { background: rgba(56, 189, 248, 0.05); border: 1px solid var(--accent); color: var(--accent); padding: 8px 14px; border-radius: 12px; font-size: 11px; white-space: nowrap; cursor: pointer; font-weight: 600; }

        /* Area Input */
        .input-wrapper { padding: 12px; background: #070a13; border-top: 1px solid var(--border); display: flex; gap: 8px; align-items: center; width: 100%; }
        #userQuery { background: #1e293b; border: 1px solid var(--border); color: #fff; flex: 1; min-width: 0; padding: 10px 15px; border-radius: 20px; outline: none; }
        .btn-send { background: var(--accent); border: none; width: 42px; height: 42px; border-radius: 50%; flex-shrink: 0; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="nav-bar">
    <div class="nav-item active" onclick="showTab(this, 'home')">ğŸ  Home</div>
    <div class="nav-item" onclick="showTab(this, 'ai')">ğŸ“Š Analyst</div>
    <div class="nav-item" onclick="showTab(this, 'clear')">âœ¨ Enhancer</div>
</div>

<div class="lang-selector">
    <button class="lang-btn active" onclick="setLang('id', this)">ğŸ‡²ğŸ‡¨ID</button>
    <button class="lang-btn" onclick="setLang('en', this)">ğŸ‡ºğŸ‡²EN</button>
    <button class="lang-btn" onclick="setLang('zh', this)">ğŸ‡¨ğŸ‡³ZH</button>
</div>

<div class="container">
    <div id="home" class="section active">
        <div class="card">
            <img src="/static/uploads/100003748.jpg" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--accent); object-fit: cover;">
            <h1>$CATON</h1>
            <p id="h-desc">Meme coin pertama di ekosistem paxi L1 dengan utilitas AI</p>
            <div class="ca-box">paxi1vgd3f2z0kt21dlk2pum0pqyshy50dqzgtxrr2pzu3lgy029awjkstqqmg9</div>
            <a href="https://t.me/+Vr2EQmXy66w0YzM1" target="_blank" class="btn-tg" id="h-tg">Gabung Telegram</a>
        </div>
        <div class="cat-grid">
            {% for cat in cats %}
            <div class="cat-card"><img src="/static/uploads/{{ cat.img }}"></div>
            {% endfor %}
        </div>
    </div>

    <div id="ai" class="section">
        <div class="chat-container">
            <div id="chatMessages" class="chat-messages">
                <div class="ai-bubble" id="ai-greet"><strong>CATOVISION Analyst</strong><br>Analis Kripto Profesional. Gunakan parameter teknikal di bawah untuk hasil akurat.</div>
            </div>
            
            <div class="quick-actions">
                <button class="btn-quick" id="q1" onclick="quickQuery('BTC')">ğŸ“ˆ BTC Price Action</button>
                <button class="btn-quick" id="q2" onclick="quickQuery('SOL')">ğŸ¯ SOL Scalping Setup</button>
                <button class="btn-quick" id="q3" onclick="quickQuery('ETH')">ğŸ’ ETH Liquidity Levels</button>
            </div>

            <div class="input-wrapper">
                <input id="imageInput" type="file" accept="image/*" style="display:none;" onchange="alert('Gambar siap dianalisis!')">
                <button onclick="document.getElementById('imageInput').click()" style="background:none; border:none; cursor:pointer; font-size:18px;">ğŸ“</button>
                <input id="userQuery" type="text" placeholder="Tanyakan market..." autocomplete="off">
                <button class="btn-send" onclick="askAI()">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="clear" class="section">
        <div class="card">
            <h3 id="e-title">âœ¨ AI Photo Enhancer</h3>
            <form action="/enhance" method="post" enctype="multipart/form-data">
                <input type="file" name="photo" accept="image/*" required style="display:block; width:100%; margin:15px 0; color:white;">
                <button type="submit" class="btn-tg" style="width:100%; border:none; cursor:pointer;" id="e-btn">Proses Gambar HD</button>
            </form>
        </div>
    </div>
</div>

<script>
    let curLang = 'id';
    const trans = {
        id: { 
            h_desc: "Meme coin pertama di ekosistem paxi L1", 
            h_tg: "Gabung Telegram", 
            ai_greet: "<strong>CATOVISION</strong><br>Analisis market kripto 100% akurat siap.", 
            loading: "Menghitung parameter teknikal...", 
            q1: "ğŸ“ˆ BTC Price Action", 
            q2: "ğŸ¯ SOL Scalping Setup", 
            q3: "ğŸ’ ETH Liquidity Levels" 
        },
        en: { 
            h_desc: "First meme coin on paxi L1", 
            h_tg: "Join Telegram", 
            ai_greet: "<strong>CATOVISION</strong><br>Professional technical analysis ready.", 
            loading: "Calculating technical parameters...", 
            q1: "ğŸ“ˆ BTC Price Action", 
            q2: "ğŸ¯ SOL Scalping Setup", 
            q3: "ğŸ’ ETH Liquidity Levels" 
        },
        zh: { 
            h_desc: "Paxi L1 é¦–ä¸ªæ¨¡å› å¸", 
            h_tg: "åŠ å…¥ Telegram", 
            ai_greet: "<strong>CATOVISION</strong><br>ä¸“ä¸šæŠ€æœ¯åˆ†æå·²å°±ç»ªã€‚", 
            loading: "è®¡ç®—æŠ€æœ¯å‚æ•°ä¸­...", 
            q1: "ğŸ“ˆ BTC ä»·æ ¼è¡Œä¸º", 
            q2: "ğŸ¯ SOL å‰¥å¤´çš®è®¾ç½®", 
            q3: "ğŸ’ ETH æµåŠ¨æ€§æ°´å¹³" 
        }
    };

    function setLang(l, btn) {
        curLang = l;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('h-desc').innerText = trans[l].h_desc;
        document.getElementById('h-tg').innerText = trans[l].h_tg;
        document.getElementById('ai-greet').innerHTML = trans[l].ai_greet;
        document.getElementById('q1').innerText = trans[l].q1;
        document.getElementById('q2').innerText = trans[l].q2;
        document.getElementById('q3').innerText = trans[l].q3;
    }

    function showTab(btn, id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // Fungsi Quick Query disesuaikan dengan terminologi teknis trading yang akurat
    function quickQuery(asset) {
        let prompt = "";
        if (asset === 'BTC') {
            prompt = curLang === 'id' ? "Analisis Price Action Bitcoin (BTC). Identifikasi Major Market Structure (MS), tren saat ini, dan potensi Breakout atau Rejection di zona Supply/Demand." : 
                     curLang === 'zh' ? "åˆ†ææ¯”ç‰¹å¸ (BTC) çš„ä»·æ ¼è¡Œä¸ºã€‚è¯†åˆ«ä¸»è¦çš„å¸‚åœºç»“æ„ (MS)ã€å½“å‰è¶‹åŠ¿ä»¥åŠä¾›åº”/éœ€æ±‚åŒºçš„æ½œåœ¨çªç ´æˆ–æ‹’ç»ã€‚" :
                     "Analyze Bitcoin (BTC) Price Action. Identify Major Market Structure (MS), current trend, and potential Breakout or Rejection at Supply/Demand zones.";
        } else if (asset === 'SOL') {
            prompt = curLang === 'id' ? "Berikan Scalping Setup untuk Solana (SOL). Tentukan zona High Probability Entry berdasarkan Fibonacci Retracement, RSI, dan target Profit Take (TP) serta Stop Loss (SL) yang ketat." : 
                     curLang === 'zh' ? "æä¾› Solana (SOL) çš„å‰¥å¤´çš®äº¤æ˜“è®¾ç½®ã€‚æ ¹æ®æ–æ³¢é‚£å¥‘å›è°ƒã€RSI ç¡®å®šé«˜æ¦‚ç‡å…¥åœºåŒºåŸŸï¼Œå¹¶è®¾å®šä¸¥æ ¼çš„æ­¢ç›ˆ (TP) å’Œæ­¢æŸ (SL) ç›®æ ‡ã€‚" :
                     "Provide a Scalping Setup for Solana (SOL). Determine High Probability Entry zones based on Fibonacci Retracement, RSI, and set tight Take Profit (TP) and Stop Loss (SL) targets.";
        } else if (asset === 'ETH') {
            prompt = curLang === 'id' ? "Tentukan Key Liquidity Levels untuk Ethereum (ETH). Analisis area Support/Resistance horizontal dan identifikasi di mana terdapat penumpukan order (Order Block) yang signifikan hari ini." : 
                     curLang === 'zh' ? "ç¡®å®šä»¥å¤ªåŠ (ETH) çš„å…³é”®æµåŠ¨æ€§æ°´å¹³ã€‚åˆ†ææ°´å¹³æ”¯æ’‘/é˜»åŠ›åŒºåŸŸï¼Œå¹¶è¯†åˆ«ä»Šå¤©å­˜åœ¨æ˜¾è‘—è®¢å•å— (Order Block) çš„åŒºåŸŸã€‚" :
                     "Define Key Liquidity Levels for Ethereum (ETH). Analyze horizontal Support/Resistance areas and identify where significant Order Blocks are located today.";
        }
        
        document.getElementById('userQuery').value = prompt;
        askAI();
    }

    async function askAI() {
        const input = document.getElementById('userQuery');
        const box = document.getElementById('chatMessages');
        const val = input.value.trim();
        if(!val) return;

        box.innerHTML += `<div class="user-bubble">${val}</div>`;
        input.value = '';
        const loadId = "L" + Date.now();
        box.innerHTML += `<div class="ai-bubble" id="${loadId}">${trans[curLang].loading}</div>`;
        box.scrollTop = box.scrollHeight;

        try {
            const fd = new FormData();
            fd.append('query', val); 
            fd.append('lang', curLang);
            const res = await fetch('/chat', { method: 'POST', body: fd });
            const data = await res.json();
            document.getElementById(loadId).innerHTML = data.reply.replace(/\n/g, '<br>');
            box.scrollTop = box.scrollHeight;
        } catch (e) { document.getElementById(loadId).innerText = "Gagal memproses analisis."; }
    }
</script>
</body>
</html>
