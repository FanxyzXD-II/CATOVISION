<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CATON | AI Tools</title>
  <style>
    :root { --bg:#020617; --card:#0f172a; --text:#f8fafc; --accent:#38bdf8; --border:#1e293b; }
    * { box-sizing: border-box; }
    body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 50px; }
    .nav-bar { display: flex; justify-content: center; gap: 10px; padding: 15px; background: var(--card); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
    .nav-item { cursor: pointer; padding: 10px 18px; border-radius: 12px; font-weight: bold; font-size: 14px; transition: 0.3s; }
    .nav-item.active { background: var(--accent); color: #020617; }
    .container { max-width: 600px; margin: 20px auto; padding: 0 15px; }
    .section { display: none; animation: fadeIn 0.4s ease; }
    .section.active { display: block; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 25px; text-align: center; }
    input, button { width: 100%; margin: 10px 0; padding: 14px; border-radius: 12px; border: none; font-size: 15px; outline: none; }
    button { background: var(--accent); color: #020617; font-weight: bold; cursor: pointer; }
    .btn-res { background: #1e293b; color: white; border: 1px solid var(--border); display: flex; justify-content: space-between; margin-bottom: 8px; }
    .btn-audio { background: #10b981; color: white; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

<div class="nav-bar">
    <div class="nav-item active" onclick="showTab(event, 'home')">üè† Home</div>
    <div class="nav-item" onclick="showTab(event, 'clear')">‚ú® Enhancer</div>
    <div class="nav-item" onclick="showTab(event, 'dl')">üé¨ Downloader</div>
</div>

<div class="container">
    <div id="home" class="section active">
        <div class="card">
            <h1>$CATON AI</h1>
            <p style="color: #94a3b8;">AI Utility Tools on Paxi Ecosystem.</p>
        </div>
    </div>

    <div id="clear" class="section">
        <div class="card">
            <h2>‚ú® AI Photo Enhancer</h2>
            <p style="font-size: 14px; color: #94a3b8;">Tingkatkan kualitas foto secara otomatis.</p>
            <form action="/enhance" method="post" enctype="multipart/form-data">
                <input type="file" name="photo" accept="image/*" required style="background: #1e293b; color: white;">
                <button type="submit">Proses & Download HD</button>
            </form>
        </div>
    </div>

    <div id="dl" class="section">
        <div class="card">
            <h2>üé¨ AI Downloader</h2>
            <p style="font-size: 14px; color: #94a3b8;">Cek resolusi sebelum mengunduh.</p>
            <input id="videoUrl" type="url" placeholder="Paste link video (YT/TikTok)" required>
            <button id="btnFetch" onclick="fetchFormats()">Cek Pilihan Kualitas</button>

            <div id="loading" style="display:none; margin: 15px; color: var(--accent);">‚è≥ Mengekstrak format...</div>

            <div id="resultArea" style="display:none; margin-top: 25px;">
                <img id="vidThumb" src="" style="width: 100%; border-radius: 12px; margin-bottom: 15px;">
                <h4 id="vidTitle" style="font-size: 14px;"></h4>
                <div id="formatList" style="margin-top: 15px;"></div>
            </div>
        </div>
    </div>
</div>

<script>
function showTab(e, id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    e.currentTarget.classList.add('active');
}

async function fetchFormats() {
    const url = document.getElementById('videoUrl').value;
    const loading = document.getElementById('loading');
    const resultArea = document.getElementById('resultArea');
    const formatList = document.getElementById('formatList');

    if(!url) return alert("Masukkan URL!");

    loading.style.display = 'block';
    resultArea.style.display = 'none';
    formatList.innerHTML = '';

    try {
        const formData = new FormData();
        formData.append('url', url);

        const response = await fetch('/get-info', { method: 'POST', body: formData });
        const data = await response.json();

        if(data.error) throw new Error(data.error);

        document.getElementById('vidThumb').src = data.thumbnail;
        document.getElementById('vidTitle').innerText = data.title;

        data.formats.forEach(f => {
            const btn = document.createElement('button');
            btn.className = 'btn-res';
            btn.innerHTML = `<span>üé¨ ${f.resolution} (${f.ext})</span> <span>${f.size}</span>`;
            btn.onclick = () => window.open(f.url, '_blank');
            formatList.appendChild(btn);
        });

        if(data.audio_url) {
            const btnA = document.createElement('button');
            btnA.className = 'btn-audio';
            btnA.innerHTML = `üéµ Download Audio (MP3)`;
            btnA.onclick = () => window.open(data.audio_url, '_blank');
            formatList.appendChild(btnA);
        }

        resultArea.style.display = 'block';
    } catch (e) {
        alert("Gagal: " + e.message);
    } finally {
        loading.style.display = 'none';
    }
}
</script>
</body>
</html>
